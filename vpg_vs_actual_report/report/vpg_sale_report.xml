<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <template id="vpg_sale_report">
        <t t-call="web.html_container">
            <t t-call="web.internal_layout">

                <t t-if="Filters.get('report_type')=='report_by_total'">
                    <t t-call="vpg_vs_actual_report.report_total"/>
                </t>

                <t t-if="Filters.get('report_type')=='report_by_local'">
                    <t t-call="vpg_vs_actual_report.report_local"/>
                </t>

                <t t-if="Filters.get('report_type')=='report_by_export'">
                    <t t-call="vpg_vs_actual_report.report_export"/>
                </t>

                <t t-if="Filters.get('report_type')=='report_by_industry'">
                    <t t-call="vpg_vs_actual_report.report_industry"/>
                </t>

            </t>
        </t>
    </template>

    <template id="report_total">
        <div class="page">
            <div class="oe_structure"/>

            <strong>From:</strong>
            <span t-if="Filters.get('date_from')">
                <t t-esc="Filters['date_from']"/>
            </span>

            <br/>

            <strong>To:</strong>
            <span t-if="Filters.get('date_to')">
                <t t-esc="Filters['date_to']"/>
            </span>


            <div>
                <div style="width:100%;">
                    <div style="text-align:centre;" class="row">

                        <div class="col-2">
                            <strong>Report Type:</strong>
                            <span>Report By Total</span>
                        </div>

                    </div>
                </div>

                <br></br>
                <table class="table table-sm table-reports">
                    <thead>
                        <tr class="text-right">
                            <th style="text-align:left;">Product Category</th>
                            <th style="text-align:left;">Products</th>
                            <th style="text-align:center;">Forecasted Total Sales</th>
                            <!--                            <th style="text-align:center;">VS</th>-->
                            <th style="text-align:center;">Actual Total Sales</th>
                            <th style="text-align:center;">Variance in cases</th>
                            <th style="text-align:center;">Variance %</th>
                            <th style="text-align:center;">Variance $</th>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-set="term" t-value="report_data.get('total_categ')"/>
                        <t t-foreach="term.values()" t-as="dynamic_vpg_report">
                            <t t-foreach="dynamic_vpg_report" t-as="line">
                                <tr style="border: 1.5px solid black;" class="pr-line">

                                    <td style="text-align:left;">
                                        <span>
                                            <t t-esc="line['product_cat']"/>
                                        </span>
                                    </td>
                                    <td style="text-align:left;">
                                        <span>
                                            <t t-esc="line['product']"/>
                                        </span>
                                    </td>
                                    <td style="text-align:center;">
                                        <span>
                                            <t t-esc="line['forecasted']"/>
                                        </span>
                                    </td>
                                    <!--                                    <td style="text-align:center;">-->
                                    <!--                                        <span>-->
                                    <!--                                            <t t-esc=''/>-->
                                    <!--                                        </span>-->
                                    <!--                                    </td>-->
                                    <td style="text-align:center;">
                                        <span>
                                            <t t-esc="line['actual_qty']"/>
                                        </span>
                                    </td>
                                    <td style="text-align:center;">
                                        <span>
                                            <t t-esc="line['forecasted'] - line['actual_qty']"/>
                                        </span>
                                    </td>
                                    <td style="text-align:center;">
                                        <span>
                                            <t t-esc="round((line['forecasted'] - line['actual_qty'])/line['forecasted'] * 100)"/>
                                        </span>
                                    </td>
                                    <td style="text-align:center;">
                                        <span>
                                            <t t-esc="(line['forecasted_total'] - line['actual_total'])"/>
                                        </span>
                                    </td>
                                </tr>
                            </t>
                            <!--                            </t>-->
                        </t>
                    </tbody>
                </table>
            </div>
            <br></br>
        </div>
    </template>

    <template id="report_local">
        <div class="page">
            <div class="oe_structure"/>

            <strong>From:</strong>
            <span t-if="Filters.get('date_from')">
                <t t-esc="Filters['date_from']"/>
            </span>

            <br/>

            <strong>To:</strong>
            <span t-if="Filters.get('date_to')">
                <t t-esc="Filters['date_to']"/>
            </span>


            <div>
                <div style="width:100%;">
                    <div style="text-align:centre;" class="row">

                        <div class="col-2">
                            <strong>Report Type:</strong>
                            <span>Report By Local</span>
                        </div>

                    </div>
                </div>


                <br></br>
                <table class="table table-sm table-reports">
                    <thead>
                        <tr class="text-right">
                            <th style="text-align:left;">Product Category</th>
                            <th style="text-align:left;">Products</th>
                            <th style="text-align:center;">Forecasted Total Sales</th>
                            <!--                            <th style="text-align:center;">VS</th>-->
                            <th style="text-align:center;">Actual Total Sales</th>
                            <th style="text-align:center;">Variance in cases</th>
                            <th style="text-align:center;">Variance %</th>
                            <th style="text-align:center;">Variance $</th>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-set="term" t-value="report_data.get('loc_categ')"/>
                        <t t-foreach="term.values()" t-as="dynamic_vpg_report">
                            <t t-foreach="dynamic_vpg_report" t-as="line">
                                <tr style="border: 1.5px solid black;" class="pr-line">

                                    <td style="text-align:left;">
                                        <span>
                                            <t t-esc="line['product_cat']"/>
                                        </span>
                                    </td>
                                    <td style="text-align:left;">
                                        <span>
                                            <t t-esc="line['product']"/>
                                        </span>
                                    </td>
                                    <td style="text-align:center;">
                                        <span>
                                            <t t-esc="line['forecasted']"/>
                                        </span>
                                    </td>
                                    <!--                                    <td style="text-align:center;">-->
                                    <!--                                        <span>-->
                                    <!--                                            <t t-esc=''/>-->
                                    <!--                                        </span>-->
                                    <!--                                    </td>-->
                                    <td style="text-align:center;">
                                        <span>
                                            <t t-esc="line['actual_qty']"/>
                                        </span>
                                    </td>
                                    <td style="text-align:center;">
                                        <span>
                                            <t t-esc="line['forecasted'] - line['actual_qty']"/>
                                        </span>
                                    </td>
                                    <td style="text-align:center;">
                                        <span>
                                            <t t-esc="round((line['forecasted'] - line['actual_qty'])/line['forecasted'] * 100)"/>
                                        </span>
                                    </td>
                                    <td style="text-align:center;">
                                        <span>
                                            <t t-esc="(line['forecasted_total'] - line['actual_total'])"/>
                                        </span>
                                    </td>
                                </tr>
                            </t>
                            <!--                            </t>-->
                        </t>
                    </tbody>
                </table>
            </div>
            <br></br>
        </div>

    </template>

    <template id="report_export">
        <div class="page">
            <div class="oe_structure"/>

            <strong>From:</strong>
            <span t-if="Filters.get('date_from')">
                <t t-esc="Filters['date_from']"/>
            </span>

            <br/>

            <strong>To:</strong>
            <span t-if="Filters.get('date_to')">
                <t t-esc="Filters['date_to']"/>
            </span>


            <div>
                <div style="width:100%;">
                    <div style="text-align:centre;" class="row">

                        <div class="col-2">
                            <strong>Report Type:</strong>
                            <span>Report By Export</span>
                        </div>

                    </div>
                </div>


                <br></br>
                <table class="table table-sm table-reports">
                    <thead>
                        <tr class="text-right">
                            <th style="text-align:left;">Product Category</th>
                            <th style="text-align:left;">Products</th>
                            <th style="text-align:center;">Forecasted Total Sales</th>
                            <!--                            <th style="text-align:center;">VS</th>-->
                            <th style="text-align:center;">Actual Total Sales</th>
                            <th style="text-align:center;">Variance in cases</th>
                            <th style="text-align:center;">Variance %</th>
                            <th style="text-align:center;">Variance $</th>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-set="term" t-value="report_data.get('exp_categ')"/>
                        <t t-foreach="term.values()" t-as="dynamic_vpg_report">
                            <t t-foreach="dynamic_vpg_report" t-as="line">
                                <tr style="border: 1.5px solid black;" class="pr-line">

                                    <td style="text-align:left;">
                                        <span>
                                            <t t-esc="line['product_cat']"/>
                                        </span>
                                    </td>
                                    <td style="text-align:left;">
                                        <span>
                                            <t t-esc="line['product']"/>
                                        </span>
                                    </td>
                                    <td style="text-align:center;">
                                        <span>
                                            <t t-esc="line['forecasted']"/>
                                        </span>
                                    </td>
                                    <!--                                    <td style="text-align:center;">-->
                                    <!--                                        <span>-->
                                    <!--                                            <t t-esc=''/>-->
                                    <!--                                        </span>-->
                                    <!--                                    </td>-->
                                    <td style="text-align:center;">
                                        <span>
                                            <t t-esc="line['actual_qty']"/>
                                        </span>
                                    </td>
                                    <td style="text-align:center;">
                                        <span>
                                            <t t-esc="line['forecasted'] - line['actual_qty']"/>
                                        </span>
                                    </td>
                                    <td style="text-align:center;">
                                        <span>
                                            <t t-esc="round((line['forecasted'] - line['actual_qty'])/line['forecasted'] * 100)"/>
                                        </span>
                                    </td>
                                    <td style="text-align:center;">
                                        <span>
                                            <t t-esc="(line['forecasted_total'] - line['actual_total'])"/>
                                        </span>
                                    </td>
                                </tr>
                            </t>
                            <!--                            </t>-->
                        </t>
                    </tbody>
                </table>
            </div>
            <br></br>
        </div>
    </template>

    <template id="report_industry">
        <div class="page">
            <div class="oe_structure"/>

            <strong>From:</strong>
            <span t-if="Filters.get('date_from')">
                <t t-esc="Filters['date_from']"/>
            </span>

            <br/>

            <strong>To:</strong>
            <span t-if="Filters.get('date_to')">
                <t t-esc="Filters['date_to']"/>
            </span>


            <div>
                <div style="width:100%;">
                    <div style="text-align:centre;" class="row">

                        <div class="col-2">
                            <strong>Report Type:</strong>
                            <span>Report By Industrial</span>
                        </div>

                    </div>
                </div>


                <br></br>
                <table class="table table-sm table-reports">
                    <thead>
                        <tr class="text-right">
                            <th style="text-align:left;">Product Category</th>
                            <th style="text-align:left;">Products</th>
                            <th style="text-align:center;">Forecasted Total Sales</th>
                            <!--                            <th style="text-align:center;">VS</th>-->
                            <th style="text-align:center;">Actual Total Sales</th>
                            <th style="text-align:center;">Variance in cases</th>
                            <th style="text-align:center;">Variance %</th>
                            <th style="text-align:center;">Variance $</th>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-set="term" t-value="report_data.get('ind_categ')"/>
                        <t t-foreach="term.values()" t-as="dynamic_vpg_report">
                            <t t-foreach="dynamic_vpg_report" t-as="line">
                                <tr style="border: 1.5px solid black;" class="pr-line">
                                    <td style="text-align:left;">
                                        <span>
                                            <t t-esc="line['product_cat']"/>
                                        </span>
                                    </td>
                                    <td style="text-align:left;">
                                        <span>
                                            <t t-esc="line['product']"/>
                                        </span>
                                    </td>
                                    <td style="text-align:center;">
                                        <span>
                                            <t t-esc="line['forecasted']"/>
                                        </span>
                                    </td>
                                    <!--                                    <td style="text-align:center;">-->
                                    <!--                                        <span>-->
                                    <!--                                            <t t-esc=''/>-->
                                    <!--                                        </span>-->
                                    <!--                                    </td>-->
                                    <td style="text-align:center;">
                                        <span>
                                            <t t-esc="line['actual_qty']"/>
                                        </span>
                                    </td>
                                    <td style="text-align:center;">
                                        <span>
                                            <t t-esc="line['forecasted'] - line['actual_qty']"/>
                                        </span>
                                    </td>
                                    <td style="text-align:center;">
                                        <span>
                                            <t t-esc="round((line['forecasted'] - line['actual_qty'])/line['forecasted'] * 100)"/>
                                        </span>
                                    </td>
                                    <td style="text-align:center;">
                                        <span>
                                            <t t-esc="(line['forecasted_total'] - line['actual_total'])"/>
                                        </span>
                                    </td>
                                </tr>
                            </t>
                            <!--                            </t>-->
                        </t>
                    </tbody>
                </table>
            </div>
            <br></br>
        </div>
    </template>


    <record id="action_report_vpg_actual" model="ir.actions.report">
        <field name="name">VPG vs SALE REPORT</field>
        <field name="model">vpg.actual.sale</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">vpg_vs_actual_report.vpg_sale_report</field>
        <field name="report_file">vpg_vs_actual_report.vpg_sale_report</field>
    </record>

</odoo>